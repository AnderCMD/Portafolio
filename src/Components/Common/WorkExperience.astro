---
import { useLocale } from '@/Hooks/useLocale';
import AButton from '@/Components/Common/AButton.astro';
const { t } = useLocale(Astro);

function getMonths(dateRange: string) {
	const [start, end] = dateRange.split('•').map((d) => d.trim());
	const [startMonth, startYear] = start.split('/').map(Number);
	const [endMonth, endYear] = end.split('/').map(Number);

	const months = (endYear - startYear) * 12 + (endMonth - startMonth) + 1;
	return months;
}

const workExperience = [
	{
		active: true,
		nameCompany: 'Resser Tecnologías S.A. de C.V. ',
		position: t('WorkExperience.Companies.Position.4'),
		date: '06/2025 • 09/2025',
		description: t('WorkExperience.Companies.Description.4'),
	},
	{
		active: false,
		nameCompany: 'AMEDigital A.C.',
		position: t('WorkExperience.Companies.Position.3'),
		date: '07/2024 • 12/2024 ',
		description: t('WorkExperience.Companies.Description.3'),
		visit: 'https://www.amedigital.mx/',
	},
	{
		active: false,
		nameCompany: 'Diagnostico Moderno',
		position: t('WorkExperience.Companies.Position.2'),
		date: '03/2023 • 12/2024',
		description: t('WorkExperience.Companies.Description.2'),
		visit: 'https://www.diagnosticomoderno.com/',
	},
	{
		active: false,
		nameCompany: 'Intellion',
		position: t('WorkExperience.Companies.Position.1'),
		date: '05/2023 • 04/2024',
		description: t('WorkExperience.Companies.Description.1'),
		visit: '',
	},
];
---

<ol class='relative my-12 space-y-8'>
	{
		workExperience.map((WorkExperience, index) => (
			<li class='group relative animate-slide-up' style={`animation-delay: ${index * 0.1}s`}>
				{/* Timeline connector */}
				<div class='absolute left-0 top-0 bottom-0 w-0.5 bg-linear-to-b from-sky-500 via-blue-500 to-transparent dark:from-sky-400 dark:via-blue-400' />

				{/* Timeline dot */}
				<div class='absolute left-0 top-8 -translate-x-1/2 z-10'>
					<div class='relative'>
						<div class='absolute inset-0 bg-sky-500 dark:bg-sky-400 rounded-full blur-md animate-pulse' />
						<div class='relative flex items-center justify-center w-10 h-10 bg-linear-to-br from-sky-500 to-blue-600 dark:from-sky-400 dark:to-blue-500 rounded-full shadow-lg ring-4 ring-white dark:ring-slate-900 group-hover:scale-110 transition-transform duration-300'>
							<i class='fa-solid fa-briefcase text-white text-sm' />
						</div>
					</div>
				</div>

				{/* Content Card */}
				<div class='ml-12 p-6 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-lg hover:shadow-xl hover:shadow-sky-500/10 transition-all duration-300 group-hover:-translate-y-1'>
					{/* Header */}
					<div class='flex flex-col lg:flex-row lg:items-start lg:justify-between gap-3 mb-4'>
						<div class='space-y-2'>
							<h3 class='text-xl font-bold text-slate-900 dark:text-white group-hover:text-sky-600 dark:group-hover:text-sky-400 transition-colors'>
								{WorkExperience.position}
							</h3>
							<p class='text-base font-semibold text-transparent bg-clip-text bg-linear-to-r from-sky-600 to-blue-600 dark:from-sky-400 dark:to-blue-400'>
								{WorkExperience.nameCompany}
							</p>
						</div>
						{WorkExperience.active && (
							<span class='inline-flex items-center gap-2 px-4 py-2 text-sm font-bold text-white bg-linear-to-r from-emerald-500 to-teal-600 rounded-full shadow-md animate-pulse'>
								<span class='w-2 h-2 bg-white rounded-full animate-ping' />
								{t('WorkExperience.Active')}
							</span>
						)}
					</div>

					{/* Date & Duration */}
					<time class='flex flex-wrap items-center gap-3 mb-4 text-sm text-slate-600 dark:text-slate-400'>
						<span class='inline-flex items-center gap-2 px-3 py-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 font-medium'>
							<i class='fa-regular fa-calendar text-sky-500' />
							{WorkExperience.date}
						</span>
						<span class='inline-flex items-center gap-2 px-3 py-1.5 rounded-lg bg-linear-to-r from-sky-100 to-blue-100 dark:from-sky-900/50 dark:to-blue-900/50 text-sky-700 dark:text-sky-300 font-semibold'>
							<i class='fa-regular fa-clock' />
							{getMonths(WorkExperience.date)}{' '}
							{getMonths(WorkExperience.date) === 1
								? t('WorkExperience.Month')
								: t('WorkExperience.Months')}
						</span>
					</time>

					{/* Description */}
					<div class='prose prose-sm max-w-none mb-4'>
						<p class='text-base leading-relaxed text-slate-700 dark:text-slate-300 whitespace-pre-line'>
							{WorkExperience.description}
						</p>
					</div>

					{/* Action Button */}
					{WorkExperience.visit && (
						<div class='flex justify-start pt-4 border-t border-slate-200 dark:border-slate-700'>
							<AButton
								href={WorkExperience.visit}
								texto={t('WorkExperience.Visit')}
								newPage
								icon='fa-solid fa-arrow-up-right-from-square'
								variant='primary'
							/>
						</div>
					)}
				</div>
			</li>
		))
	}
</ol>
