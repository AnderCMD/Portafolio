---
import { useLocale } from '@/Hooks/useLocale';
import AButton from '@/Components/Common/AButton.astro';
const { t } = useLocale(Astro);

// Enhanced work experience data with additional fields
const workExperience = [
	{
		active: false,
		nameCompany: 'AMEDigital A.C.',
		position: t('WorkExperience.Companies.Position.3'),
		date: '07/2024 • 12/2024 ',
		description: t('WorkExperience.Companies.Description.3'),
		visit: 'https://www.amedigital.mx/',
		logo: '/Images/Companies/AMEDigital.webp', // Add company logos if available
		skills: ['Astro', 'TailwindCSS', 'JavaScript'], // Add relevant skills
		color: '#0ea5e9', // Primary brand color
	},
	{
		active: false,
		nameCompany: 'Diagnostico Moderno',
		position: t('WorkExperience.Companies.Position.2'),
		date: '03/2023 • 12/2024',
		description: t('WorkExperience.Companies.Description.2'),
		visit: 'https://www.diagnosticomoderno.com/',
		logo: '/Images/Companies/DiagnosticoModerno.webp',
		skills: ['Astro', 'TailwindCSS', 'JavaScript'],
		color: '#0369a1',
	},
	{
		active: false,
		nameCompany: 'Intellion',
		position: t('WorkExperience.Companies.Position.1'),
		date: '05/2023 • 04/2024',
		description: t('WorkExperience.Companies.Description.1'),
		visit: '',
		logo: '/Images/Companies/Intellion.webp',
		skills: ['HTML', 'CSS', 'JavaScript'],
		color: '#0284c7',
	},
];
---

<div class='container mx-auto px-4 py-6'>
	<div class='relative py-6'>
		<!-- Timeline line -->
		<div class='absolute top-0 bottom-0 left-6 w-0.5 bg-gradient-to-b from-sky-200 via-sky-500/60 to-sky-200 dark:from-sky-900/20 dark:via-sky-500/60 dark:to-sky-900/20 z-10'></div>

		{
			workExperience.map((experience, index) => (
				<div
					class='relative pl-14 mb-10 last:mb-0 transition-all duration-300 ease-in-out'
					data-aos='fade-up'
					data-aos-duration='600'
					data-aos-delay={index * 100}
					data-aos-once='true'>
					<!-- Timeline dot -->
					<div 
						class={`absolute left-0 w-12 h-12 rounded-full bg-white dark:bg-slate-800 flex items-center justify-center shadow-md z-20 transition-all duration-300 ease-in-out border-2 ${experience.active ? 'border-sky-500 shadow-sky-200 dark:shadow-sky-900/20' : 'border-sky-300 dark:border-sky-700'} hover:scale-105 hover:shadow-lg`}
						style={`--tw-shadow-color: ${experience.color}20;`}>
						{experience.logo ? (
							<img
								src={experience.logo}
								alt={experience.nameCompany}
								class='rounded-full object-cover w-6 h-6'
								onerror={`this.onerror=null; this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(experience.nameCompany)}&background=0D8ABC&color=fff'`}
							/>
						) : (
							<svg
								aria-hidden='true'
								xmlns='http://www.w3.org/2000/svg'
								fill='currentColor'
								class='w-6 h-6 text-sky-500'
								viewBox='0 0 20 20'>
								<path d='M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z' />
							</svg>
						)}
					</div>

					<!-- Timeline content -->
					<div 
						class='bg-white dark:bg-slate-800 rounded-xl p-5 shadow-md transition-all duration-300 ease-in-out border border-slate-200 dark:border-slate-700 hover:-translate-y-1 hover:shadow-lg relative overflow-hidden group'
						style={`--company-color: ${experience.color}`}>
						<!-- Left border accent -->
						<div class='absolute top-0 left-0 w-1 h-full rounded-l-xl' style={`background-color: ${experience.color}`}></div>
						
						<div class='flex flex-wrap items-center gap-2 mb-2'>
							<h3 class='text-lg font-bold text-slate-900 dark:text-white'>{experience.position}</h3>
							<span class='font-bold bg-clip-text text-transparent bg-gradient-to-r' style={`--tw-gradient-from: ${experience.color}; --tw-gradient-to: ${experience.color}80;`}>@ {experience.nameCompany}</span>

							{experience.active && (
								<span class='ml-auto text-xs font-semibold text-white px-3 py-1 rounded-full shadow-sm flex items-center bg-gradient-to-r from-sky-500 to-sky-400'>
									<i class='fa-solid fa-circle-check mr-1' />
									{t('WorkExperience.Active')}
								</span>
							)}

							{/* Si es el mas reciente */}
							{index === 0 && (
								<span class='ml-auto text-xs font-semibold text-white px-3 py-1 rounded-full shadow-sm flex items-center bg-gradient-to-r from-sky-500 to-sky-400'>
									<i class='fa-solid fa-calendar mr-1' />
									{t('WorkExperience.Recent')}
								</span>
							)}
						</div>

						<div class='inline-flex items-center px-3 py-1 bg-slate-100 dark:bg-slate-700/50 rounded-full text-xs text-slate-600 dark:text-slate-300 mb-3'>
							<i class='fa-regular fa-calendar mr-2 text-slate-500 dark:text-slate-400' />
							{t('WorkExperience.ReleaseDate')} {experience.date}
						</div>

						<p class='mb-3 text-slate-700 dark:text-slate-300 leading-relaxed text-sm md:text-base'>
							{experience.description}
						</p>

						{experience.skills && experience.skills.length > 0 && (
							<div class='mb-3'>
								{experience.skills.map((skill) => (
									<span class='inline-block text-xs px-2 py-0.5 rounded bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 font-medium mr-1.5 mb-1.5 transition-colors duration-200 ease-in-out group-hover:bg-slate-200 dark:group-hover:bg-slate-600'>{skill}</span>
								))}
							</div>
						)}

						{experience.visit && (
							<a 
								href={experience.visit} 
								target='_blank' 
								rel='noopener noreferrer' 
								class='inline-flex items-center px-3.5 py-1.5 mt-2 text-sm font-semibold text-white rounded-lg shadow-sm transition-all duration-300 ease-in-out hover:-translate-y-0.5 hover:shadow-md relative overflow-hidden group'
								style={`background: linear-gradient(135deg, ${experience.color} 0%, ${experience.color}80 100%);`}>
								{t('WorkExperience.Visit')}
								<i class='fa-solid fa-external-link ml-2' />
								<span class="absolute top-0 left-0 w-full h-full bg-white/20 opacity-0 scale-x-0 origin-left group-hover:scale-x-100 group-hover:opacity-100 transition-all duration-500 ease-in-out"></span>
							</a>
						)}
					</div>
				</div>
			))
		}
	</div>
</div>

<script>
	import AOS from 'aos';

	document.addEventListener('astro:page-load', () => {
		// Initialize AOS with custom settings
		AOS.init({
			duration: 600,
			easing: 'ease-out-cubic',
			once: true,
			offset: 30,
			disableMutationObserver: false,
		});
	});
</script>
