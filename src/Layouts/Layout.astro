---
// Tipos de datos de los props
interface Props {
	title: string;
	description?: string;
	image?: string;
	type?: 'website' | 'article' | 'profile';
	keywords?: string;
}

// Props
const { title, description, image = '/Icons/Icono-Negro.ico', type = 'website', keywords } = Astro.props;

// Componentes
import Navbar from '@/Components/Common/Navbar.astro';
import Footer from '@/Components/Common/Footer.astro';

// Tailwind CSS
import '@/Styles/Default.css';

// Lenguaje
import { useLocale } from '@/Hooks/useLocale';
const { currentLocale, t } = useLocale(Astro);

// Transiciones
import { ClientRouter } from 'astro:transitions';

// SEO defaults
const seoDescription = description || t('About.Description');
const siteUrl = Astro.url.origin;
const canonicalURL = new URL(Astro.url.pathname, siteUrl);
const ogImageURL = new URL(image, siteUrl);
const currentYear = new Date().getFullYear();

// Keywords por defecto
const defaultKeywords =
	'Ander González, AnderCMD, Full Stack Developer, Software Engineer, React, Astro, TypeScript, Web Development, Desarrollador Web, Ingeniero en Software';
const seoKeywords = keywords ? `${keywords}, ${defaultKeywords}` : defaultKeywords;

// Schema.org JSON-LD
const schemaOrg = {
	'@context': 'https://schema.org',
	'@type': 'Person',
	name: 'Ander González González',
	alternateName: 'AnderCMD',
	jobTitle: 'Full Stack Software Engineer',
	description: seoDescription,
	url: siteUrl,
	image: ogImageURL.href,
	sameAs: ['https://github.com/AnderCMD', 'https://www.linkedin.com/in/andercmd/'],
	knowsAbout: [
		'Software Engineering',
		'Web Development',
		'React',
		'Astro',
		'TypeScript',
		'JavaScript',
		'Full Stack Development',
	],
};
---

<!doctype html>
<html lang={currentLocale} class='scroll-smooth dark'>
	<head>
		<!-- Essential Meta Tags -->
		<meta charset='UTF-8' />
		<meta name='viewport' content='width=device-width, initial-scale=1.0' />
		<meta http-equiv='X-UA-Compatible' content='IE=edge' />

		<!-- Preload Critical Assets - Dark Mode Logos (Default) -->
		<link rel='preload' href='/Logos/Logo-Blanco.webp' as='image' type='image/webp' fetchpriority='high' />
		<link rel='preload' href='/Logos/Icono-Blanco.webp' as='image' type='image/webp' fetchpriority='high' />

		<!-- Font Awesome - Carga asíncrona para no bloquear renderizado -->
		<link rel='preload' href='/FontAwesome/css/all.min.css' as='style' />
		<link
			rel='stylesheet'
			href='/FontAwesome/css/all.min.css'
			media='print'
			onload="this.media='all'; this.onload=null;"
		/>
		<noscript><link rel='stylesheet' href='/FontAwesome/css/all.min.css' /></noscript>

		<!-- Inline Theme Script - Evita FOUC (Flash of Unstyled Content) -->
		<script is:inline>
			// Aplicar tema inmediatamente - Dark mode por defecto
			(function () {
				const savedTheme = localStorage.getItem('Theme');
				const theme = savedTheme || 'dark';

				if (theme === 'dark') {
					document.documentElement.classList.add('dark');
				} else {
					document.documentElement.classList.remove('dark');
				}
			})();

			// Función global para obtener la ruta correcta del logo
			window.getLogoPath = function (type, isDark) {
				if (type === 'logo') {
					return isDark ? '/Logos/Logo-Blanco.webp' : '/Logos/Logo-Negro.webp';
				} else {
					return isDark ? '/Logos/Icono-Blanco.webp' : '/Logos/Icono-Negro.webp';
				}
			};

			// Función global para actualizar todos los logos (optimizada)
			window.updateAllLogos = function () {
				const isDark = document.documentElement.classList.contains('dark');
				const logos = document.querySelectorAll('[data-logo-theme]');

				logos.forEach((logo) => {
					const type = logo.getAttribute('data-logo-theme');
					const correctPath = window.getLogoPath(type, isDark);

					// Solo actualizar si es diferente
					if (logo.getAttribute('src') !== correctPath) {
						logo.setAttribute('src', correctPath);
					}
				});
			};
		</script>

		<!-- Script para transiciones de Astro -->
		<script>
			// Extender el tipo Window
			declare global {
				interface Window {
					updateAllLogos?: () => void;
					getLogoPath?: (type: string, isDark: boolean) => string;
				}
			}

			// Función para aplicar el tema completamente (clase dark + checkbox)
			function applyTheme() {
				const savedTheme = localStorage.getItem('Theme');
				const theme = savedTheme || 'dark';
				const isDark = theme === 'dark';

				// Aplicar clase dark
				if (isDark) {
					document.documentElement.classList.add('dark');
				} else {
					document.documentElement.classList.remove('dark');
				}

				// Actualizar el estado del checkbox INMEDIATAMENTE
				const toggleDarkMode = document.getElementById('ToggleDarkMode');
				if (toggleDarkMode && toggleDarkMode instanceof HTMLInputElement) {
					toggleDarkMode.checked = isDark;
				}
			}

			// ANTES del swap - aplicar todo al nuevo documento
			document.addEventListener('astro:before-swap', (event) => {
				// Obtener el nuevo documento que se va a mostrar
				const newDocument = event.newDocument;
				const savedTheme = localStorage.getItem('Theme');
				const theme = savedTheme || 'dark';
				const isDark = theme === 'dark';

				// Aplicar clase dark al nuevo documento ANTES de mostrarlo
				if (isDark) {
					newDocument.documentElement.classList.add('dark');
				} else {
					newDocument.documentElement.classList.remove('dark');
				}

				// Actualizar el checkbox en el nuevo documento ANTES de mostrarlo
				const newToggle = newDocument.getElementById('ToggleDarkMode');
				if (newToggle && newToggle instanceof HTMLInputElement) {
					newToggle.checked = isDark;
				}

				// Actualizar logos en el nuevo documento ANTES de mostrarlo
				const newLogos = newDocument.querySelectorAll('[data-logo-theme]');
				newLogos.forEach((logo) => {
					const type = logo.getAttribute('data-logo-theme');
					const correctPath = window.getLogoPath(type, isDark);
					logo.setAttribute('src', correctPath);
				});
			});

			// Después de que la página carga - solo una verificación ligera
			document.addEventListener('astro:page-load', () => {
				applyTheme();
			});
		</script>

		<!-- SEO Meta Tags -->
		<title>{title}</title>
		<meta name='description' content={seoDescription} />
		<meta name='keywords' content={seoKeywords} />
		<meta name='author' content='Ander González González (AnderCMD)' />
		<meta name='generator' content={Astro.generator} />
		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
		<link rel='canonical' href={canonicalURL} />

		<!-- Open Graph / Facebook -->
		<meta property='og:type' content={type} />
		<meta property='og:url' content={canonicalURL} />
		<meta property='og:title' content={title} />
		<meta property='og:description' content={seoDescription} />
		<meta property='og:image' content={ogImageURL} />
		<meta property='og:image:width' content='1200' />
		<meta property='og:image:height' content='630' />
		<meta property='og:site_name' content='AnderCMD Portfolio' />
		<meta property='og:locale' content={currentLocale === 'es' ? 'es_MX' : 'en_US'} />

		<!-- Twitter Card -->
		<meta name='twitter:card' content='summary_large_image' />
		<meta name='twitter:url' content={canonicalURL} />
		<meta name='twitter:title' content={title} />
		<meta name='twitter:description' content={seoDescription} />
		<meta name='twitter:image' content={ogImageURL} />
		<meta name='twitter:creator' content='@AnderCMD' />

		<!-- Favicon & Icons -->
		<link rel='icon' type='image/x-icon' href='/Icons/Icono-Negro.ico' />
		<link rel='apple-touch-icon' sizes='180x180' href='/Icons/Icono-Negro.ico' />
		<link rel='manifest' href='/manifest.json' />

		<!-- Preconnect for Performance -->
		<link rel='preconnect' href='https://raw.githubusercontent.com' crossorigin />
		<link rel='preconnect' href='https://cdn.worldvectorlogo.com' crossorigin />
		<link rel='dns-prefetch' href='https://raw.githubusercontent.com' />
		<link rel='dns-prefetch' href='https://cdn.worldvectorlogo.com' />

		<!-- Schema.org JSON-LD -->
		<script type='application/ld+json' set:html={JSON.stringify(schemaOrg)} />

		<!-- Theme Color -->
		<meta name='theme-color' content='#0ea5e9' media='(prefers-color-scheme: light)' />
		<meta name='theme-color' content='#020618' media='(prefers-color-scheme: dark)' />

		<!-- Additional SEO -->
		<meta name='format-detection' content='telephone=no' />
		<meta name='copyright' content={`© ${currentYear} Ander González González. All rights reserved.`} />
		<meta name='language' content={currentLocale} />
		<meta name='revisit-after' content='7 days' />
	</head>

	<body
		class='relative overflow-x-hidden bg-linear-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-950 dark:via-blue-950 dark:to-indigo-950 text-slate-900 dark:text-slate-100 transition-colors duration-300'>
		<!-- Modern Animated Background -->
		<div class='fixed inset-0 -z-10 overflow-hidden'>
			<!-- Gradient Orbs con animación -->
			<div class='absolute inset-0'>
				<!-- Orb 1 - Neutral Light / Sky Dark -->
				<div
					class='absolute top-0 left-0 w-96 h-96 bg-slate-200/40 dark:bg-sky-500/20 rounded-full blur-3xl animate-float'
					style='animation-delay: 0s; animation-duration: 20s;'>
				</div>
				<!-- Orb 2 - Neutral Light / Blue Dark -->
				<div
					class='absolute top-1/4 right-0 w-120 h-120 bg-slate-300/35 dark:bg-blue-600/15 rounded-full blur-3xl animate-float'
					style='animation-delay: 2s; animation-duration: 25s;'>
				</div>
				<!-- Orb 3 - Neutral Light / Indigo Dark -->
				<div
					class='absolute bottom-0 left-1/4 w-md h-112 bg-gray-200/30 dark:bg-indigo-600/15 rounded-full blur-3xl animate-float'
					style='animation-delay: 4s; animation-duration: 22s;'>
				</div>
				<!-- Orb 4 - Neutral Light / Purple Dark -->
				<div
					class='absolute bottom-1/4 right-1/4 w-80 h-80 bg-slate-300/30 dark:bg-purple-600/10 rounded-full blur-3xl animate-float'
					style='animation-delay: 6s; animation-duration: 18s;'>
				</div>
				<!-- Orb 5 - Neutral Light / Cyan Dark -->
				<div
					class='absolute top-1/2 left-1/2 w-96 h-96 bg-gray-300/35 dark:bg-cyan-500/15 rounded-full blur-3xl animate-float'
					style='animation-delay: 3s; animation-duration: 23s; transform: translate(-50%, -50%);'>
				</div>
				<!-- Orb 6 - Neutral Light / Teal Dark -->
				<div
					class='absolute top-1/3 left-1/3 w-72 h-72 bg-slate-200/30 dark:bg-teal-500/10 rounded-full blur-3xl animate-float'
					style='animation-delay: 5s; animation-duration: 21s;'>
				</div>
				<!-- Orb 7 - Neutral Light / Violet Dark -->
				<div
					class='absolute bottom-1/3 right-1/3 w-80 h-80 bg-gray-200/30 dark:bg-violet-600/12 rounded-full blur-3xl animate-float'
					style='animation-delay: 7s; animation-duration: 24s;'>
				</div>
				<!-- Orb 8 - Neutral Light / Pink Dark -->
				<div
					class='absolute top-2/3 left-1/4 w-64 h-64 bg-slate-300/25 dark:bg-pink-500/10 rounded-full blur-3xl animate-float'
					style='animation-delay: 8s; animation-duration: 26s;'>
				</div>
			</div>

			<!-- Grid Pattern Animado -->
			<div class='absolute inset-0 opacity-30 dark:opacity-10'>
				<div
					class='absolute inset-0'
					style='background-image: linear-gradient(rgba(148, 163, 184, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(148, 163, 184, 0.05) 1px, transparent 1px); background-size: 50px 50px; animation: grid-move 20s linear infinite;'>
				</div>
			</div>

			<!-- Dots Pattern Layer -->
			<div class='absolute inset-0 opacity-20 dark:opacity-10'>
				<div
					class='absolute inset-0'
					style='background-image: radial-gradient(circle, rgba(148, 163, 184, 0.2) 1px, transparent 1px); background-size: 30px 30px; animation: grid-move 25s linear infinite reverse;'>
				</div>
			</div>

			<!-- Partículas flotantes - Aumentadas a 20 -->
			<div class='absolute inset-0 overflow-hidden'>
				<!-- Partículas Neutrales en Light / Coloridas en Dark -->
				<div
					class='particle absolute w-1 h-1 bg-slate-400/25 dark:bg-sky-400/30 rounded-full'
					style='top: 10%; left: 10%; animation: float-particle 15s infinite ease-in-out;'>
				</div>
				<div
					class='particle absolute w-2 h-2 bg-gray-400/20 dark:bg-sky-300/40 rounded-full'
					style='top: 15%; left: 85%; animation: float-particle 17s infinite ease-in-out 1s;'>
				</div>
				<div
					class='particle absolute w-1.5 h-1.5 bg-slate-400/20 dark:bg-sky-400/35 rounded-full'
					style='top: 50%; left: 5%; animation: float-particle 19s infinite ease-in-out 7s;'>
				</div>

				<div
					class='particle absolute w-1.5 h-1.5 bg-gray-400/25 dark:bg-blue-400/30 rounded-full'
					style='top: 20%; left: 80%; animation: float-particle 18s infinite ease-in-out 2s;'>
				</div>
				<div
					class='particle absolute w-2 h-2 bg-slate-400/20 dark:bg-blue-300/35 rounded-full'
					style='top: 75%; left: 15%; animation: float-particle 21s infinite ease-in-out 9s;'>
				</div>
				<div
					class='particle absolute w-1 h-1 bg-gray-400/25 dark:bg-blue-400/40 rounded-full'
					style='top: 45%; left: 92%; animation: float-particle 16s infinite ease-in-out 5s;'>
				</div>

				<div
					class='particle absolute w-1 h-1 bg-slate-400/25 dark:bg-indigo-400/30 rounded-full'
					style='top: 60%; left: 20%; animation: float-particle 20s infinite ease-in-out 4s;'>
				</div>
				<div
					class='particle absolute w-1.5 h-1.5 bg-gray-400/20 dark:bg-indigo-300/35 rounded-full'
					style='top: 35%; left: 45%; animation: float-particle 22s infinite ease-in-out 6s;'>
				</div>
				<div
					class='particle absolute w-2 h-2 bg-slate-400/25 dark:bg-indigo-400/40 rounded-full'
					style='top: 85%; left: 88%; animation: float-particle 18s infinite ease-in-out 11s;'>
				</div>

				<div
					class='particle absolute w-2 h-2 bg-gray-400/20 dark:bg-purple-400/30 rounded-full'
					style='top: 80%; left: 70%; animation: float-particle 16s infinite ease-in-out 6s;'>
				</div>
				<div
					class='particle absolute w-1 h-1 bg-slate-400/25 dark:bg-purple-300/35 rounded-full'
					style='top: 25%; left: 55%; animation: float-particle 23s infinite ease-in-out 8s;'>
				</div>
				<div
					class='particle absolute w-1.5 h-1.5 bg-gray-400/25 dark:bg-purple-400/40 rounded-full'
					style='top: 65%; left: 35%; animation: float-particle 17s infinite ease-in-out 12s;'>
				</div>

				<div
					class='particle absolute w-1 h-1 bg-slate-400/20 dark:bg-cyan-400/30 rounded-full'
					style='top: 40%; left: 60%; animation: float-particle 22s infinite ease-in-out 3s;'>
				</div>
				<div
					class='particle absolute w-2 h-2 bg-gray-400/25 dark:bg-cyan-300/35 rounded-full'
					style='top: 90%; left: 50%; animation: float-particle 19s infinite ease-in-out 10s;'>
				</div>

				<div
					class='particle absolute w-1.5 h-1.5 bg-slate-400/25 dark:bg-teal-400/30 rounded-full'
					style='top: 30%; left: 25%; animation: float-particle 20s infinite ease-in-out 4s;'>
				</div>
				<div
					class='particle absolute w-1 h-1 bg-gray-400/20 dark:bg-teal-300/35 rounded-full'
					style='top: 55%; left: 75%; animation: float-particle 24s infinite ease-in-out 13s;'>
				</div>

				<div
					class='particle absolute w-1.5 h-1.5 bg-slate-400/25 dark:bg-violet-400/30 rounded-full'
					style='top: 70%; left: 40%; animation: float-particle 19s infinite ease-in-out 5s;'>
				</div>
				<div
					class='particle absolute w-2 h-2 bg-gray-400/20 dark:bg-violet-300/35 rounded-full'
					style='top: 12%; left: 65%; animation: float-particle 21s infinite ease-in-out 14s;'>
				</div>

				<div
					class='particle absolute w-1 h-1 bg-slate-400/25 dark:bg-pink-400/30 rounded-full'
					style='top: 48%; left: 82%; animation: float-particle 18s infinite ease-in-out 7s;'>
				</div>
				<div
					class='particle absolute w-1.5 h-1.5 bg-gray-400/20 dark:bg-pink-300/35 rounded-full'
					style='top: 95%; left: 30%; animation: float-particle 20s infinite ease-in-out 15s;'>
				</div>
			</div>

			<!-- Líneas decorativas animadas - Aumentadas -->
			<svg class='absolute inset-0 w-full h-full opacity-0 dark:opacity-10' xmlns='http://www.w3.org/2000/svg'>
				<defs>
					<!-- Gradientes Neutrales para Light Mode -->
					<linearGradient id='lineGradientLight1' x1='0%' y1='0%' x2='100%' y2='100%'>
						<stop offset='0%' style='stop-color: rgb(148, 163, 184); stop-opacity: 0'></stop>
						<stop offset='50%' style='stop-color: rgb(148, 163, 184); stop-opacity: 0.3'></stop>
						<stop offset='100%' style='stop-color: rgb(148, 163, 184); stop-opacity: 0'></stop>
					</linearGradient>
					<!-- Gradientes Coloridos para Dark Mode -->
					<linearGradient id='lineGradient1' x1='0%' y1='0%' x2='100%' y2='100%'>
						<stop offset='0%' style='stop-color: rgb(14, 165, 233); stop-opacity: 0'></stop>
						<stop offset='50%' style='stop-color: rgb(14, 165, 233); stop-opacity: 0.5'></stop>
						<stop offset='100%' style='stop-color: rgb(14, 165, 233); stop-opacity: 0'></stop>
					</linearGradient>
					<linearGradient id='lineGradient2' x1='100%' y1='0%' x2='0%' y2='100%'>
						<stop offset='0%' style='stop-color: rgb(99, 102, 241); stop-opacity: 0'></stop>
						<stop offset='50%' style='stop-color: rgb(99, 102, 241); stop-opacity: 0.5'></stop>
						<stop offset='100%' style='stop-color: rgb(99, 102, 241); stop-opacity: 0'></stop>
					</linearGradient>
					<linearGradient id='lineGradient3' x1='0%' y1='100%' x2='100%' y2='0%'>
						<stop offset='0%' style='stop-color: rgb(6, 182, 212); stop-opacity: 0'></stop>
						<stop offset='50%' style='stop-color: rgb(6, 182, 212); stop-opacity: 0.5'></stop>
						<stop offset='100%' style='stop-color: rgb(6, 182, 212); stop-opacity: 0'></stop>
					</linearGradient>
					<linearGradient id='lineGradient4' x1='50%' y1='0%' x2='50%' y2='100%'>
						<stop offset='0%' style='stop-color: rgb(139, 92, 246); stop-opacity: 0'></stop>
						<stop offset='50%' style='stop-color: rgb(139, 92, 246); stop-opacity: 0.5'></stop>
						<stop offset='100%' style='stop-color: rgb(139, 92, 246); stop-opacity: 0'></stop>
					</linearGradient>
					<linearGradient id='lineGradient5' x1='100%' y1='100%' x2='0%' y2='0%'>
						<stop offset='0%' style='stop-color: rgb(236, 72, 153); stop-opacity: 0'></stop>
						<stop offset='50%' style='stop-color: rgb(236, 72, 153); stop-opacity: 0.5'></stop>
						<stop offset='100%' style='stop-color: rgb(236, 72, 153); stop-opacity: 0'></stop>
					</linearGradient>
				</defs>

				<!-- Línea ondulada superior -->
				<path
					d='M 0 100 Q 250 50 500 100 T 1000 100'
					stroke='url(#lineGradient1)'
					stroke-width='2'
					fill='none'
					class='animate-path-draw'>
					<animate
						attributeName='d'
						dur='10s'
						repeatCount='indefinite'
						values='M 0 100 Q 250 50 500 100 T 1000 100; M 0 120 Q 250 70 500 120 T 1000 120; M 0 100 Q 250 50 500 100 T 1000 100'
					></animate>
				</path>

				<!-- Línea ondulada media -->
				<path
					d='M 1000 300 Q 750 250 500 300 T 0 300'
					stroke='url(#lineGradient2)'
					stroke-width='2'
					fill='none'
					class='animate-path-draw'>
					<animate
						attributeName='d'
						dur='12s'
						repeatCount='indefinite'
						values='M 1000 300 Q 750 250 500 300 T 0 300; M 1000 320 Q 750 270 500 320 T 0 320; M 1000 300 Q 750 250 500 300 T 0 300'
					></animate>
				</path>

				<!-- Línea ondulada inferior -->
				<path
					d='M 0 500 Q 300 450 600 500 T 1200 500'
					stroke='url(#lineGradient3)'
					stroke-width='2'
					fill='none'
					class='animate-path-draw'>
					<animate
						attributeName='d'
						dur='14s'
						repeatCount='indefinite'
						values='M 0 500 Q 300 450 600 500 T 1200 500; M 0 520 Q 300 470 600 520 T 1200 520; M 0 500 Q 300 450 600 500 T 1200 500'
					></animate>
				</path>

				<!-- Línea vertical ondulada izquierda -->
				<path
					d='M 200 0 Q 150 200 200 400 T 200 800'
					stroke='url(#lineGradient4)'
					stroke-width='2'
					fill='none'
					class='animate-path-draw'>
					<animate
						attributeName='d'
						dur='11s'
						repeatCount='indefinite'
						values='M 200 0 Q 150 200 200 400 T 200 800; M 220 0 Q 170 200 220 400 T 220 800; M 200 0 Q 150 200 200 400 T 200 800'
					></animate>
				</path>

				<!-- Línea vertical ondulada derecha -->
				<path
					d='M 1000 0 Q 1050 250 1000 500 T 1000 1000'
					stroke='url(#lineGradient5)'
					stroke-width='2'
					fill='none'
					class='animate-path-draw'>
					<animate
						attributeName='d'
						dur='13s'
						repeatCount='indefinite'
						values='M 1000 0 Q 1050 250 1000 500 T 1000 1000; M 980 0 Q 1030 250 980 500 T 980 1000; M 1000 0 Q 1050 250 1000 500 T 1000 1000'
					></animate>
				</path>

				<!-- Círculos animados -->
				<circle cx='150' cy='150' r='5' fill='url(#lineGradient1)' opacity='0.6'>
					<animate attributeName='r' dur='3s' repeatCount='indefinite' values='5;8;5'></animate>
					<animate attributeName='opacity' dur='3s' repeatCount='indefinite' values='0.6;0.3;0.6'></animate>
				</circle>
				<circle cx='850' cy='200' r='6' fill='url(#lineGradient2)' opacity='0.6'>
					<animate attributeName='r' dur='4s' repeatCount='indefinite' values='6;10;6'></animate>
					<animate attributeName='opacity' dur='4s' repeatCount='indefinite' values='0.6;0.3;0.6'></animate>
				</circle>
				<circle cx='400' cy='600' r='7' fill='url(#lineGradient3)' opacity='0.6'>
					<animate attributeName='r' dur='3.5s' repeatCount='indefinite' values='7;11;7'></animate>
					<animate attributeName='opacity' dur='3.5s' repeatCount='indefinite' values='0.6;0.3;0.6'></animate>
				</circle>
				<circle cx='700' cy='400' r='5' fill='url(#lineGradient4)' opacity='0.6'>
					<animate attributeName='r' dur='4.5s' repeatCount='indefinite' values='5;9;5'></animate>
					<animate attributeName='opacity' dur='4.5s' repeatCount='indefinite' values='0.6;0.3;0.6'></animate>
				</circle>
			</svg>

			<!-- Shooting Stars - Solo en dark mode -->
			<div class='absolute inset-0 overflow-hidden pointer-events-none hidden dark:block'>
				<div class='shooting-star' style='top: 20%; left: -10%; animation: shooting-star 3s ease-out infinite;'>
				</div>
				<div
					class='shooting-star'
					style='top: 40%; left: -10%; animation: shooting-star 4s ease-out infinite 1.5s;'>
				</div>
				<div
					class='shooting-star'
					style='top: 60%; left: -10%; animation: shooting-star 3.5s ease-out infinite 3s;'>
				</div>
				<div
					class='shooting-star'
					style='top: 80%; left: -10%; animation: shooting-star 4.2s ease-out infinite 4.5s;'>
				</div>
			</div>
		</div>

		<div class='relative flex flex-col min-h-screen'>
			<Navbar />
			<main class='flex-1 container mx-auto px-4 sm:px-6 lg:px-8 xl:px-16 2xl:px-24 py-8 lg:py-12'>
				<ClientRouter />
				<div class='animate-fade-in'>
					<slot />
				</div>
			</main>
			<Footer />
		</div>

		<!-- Scroll to Top Button with Progress -->
		<button id='scroll-to-top' class='fixed bottom-8 right-8 z-50 hidden group' aria-label='Scroll to top'>
			<div class='relative'>
				<!-- Progress Ring -->
				<svg class='w-14 h-14 transform -rotate-90' viewBox='0 0 56 56'>
					<circle
						cx='28'
						cy='28'
						r='24'
						fill='none'
						stroke='currentColor'
						stroke-width='2'
						class='text-slate-200 dark:text-slate-700'></circle>
					<circle
						id='scroll-progress'
						cx='28'
						cy='28'
						r='24'
						fill='none'
						stroke='currentColor'
						stroke-width='2'
						stroke-dasharray='150.8'
						stroke-dashoffset='150.8'
						stroke-linecap='round'
						class='text-sky-500 dark:text-sky-400 transition-all duration-200'></circle>
				</svg>
				<!-- Icon Button -->
				<div class='absolute inset-0 flex items-center justify-center'>
					<div
						class='w-10 h-10 bg-linear-to-br from-sky-500 to-blue-600 dark:from-sky-400 dark:to-blue-500 rounded-full flex items-center justify-center shadow-lg group-hover:shadow-xl group-hover:shadow-sky-500/50 transition-all duration-300 group-hover:scale-110'>
						<i class='fa-solid fa-arrow-up text-white text-sm'></i>
					</div>
				</div>
			</div>
		</button>

		<script>
			// Scroll to top functionality with progress - Optimizado con requestAnimationFrame
			const scrollBtn = document.getElementById('scroll-to-top');
			const progressCircle = document.getElementById('scroll-progress');
			const circumference = 150.8;

			let ticking = false;
			let lastKnownScrollPosition = 0;

			function updateScrollProgress(scrollPos: number) {
				const scrollTotal = document.documentElement.scrollHeight - window.innerHeight;
				const scrollProgress = (scrollPos / scrollTotal) * 100;
				const offset = circumference - (scrollProgress / 100) * circumference;

				if (progressCircle) {
					progressCircle.style.strokeDashoffset = offset.toString();
				}

				if (scrollPos > 300) {
					scrollBtn?.classList.remove('hidden');
					scrollBtn?.classList.add('animate-fade-in');
				} else {
					scrollBtn?.classList.add('hidden');
				}
			}

			function onScroll() {
				lastKnownScrollPosition = window.scrollY;

				if (!ticking) {
					window.requestAnimationFrame(() => {
						updateScrollProgress(lastKnownScrollPosition);
						ticking = false;
					});

					ticking = true;
				}
			}

			// Usar passive event listeners para mejor performance
			window.addEventListener('scroll', onScroll, { passive: true });

			// Debounce para resize
			let resizeTimeout: ReturnType<typeof setTimeout>;
			window.addEventListener(
				'resize',
				() => {
					clearTimeout(resizeTimeout);
					resizeTimeout = setTimeout(() => {
						updateScrollProgress(window.scrollY);
					}, 150);
				},
				{ passive: true }
			);

			scrollBtn?.addEventListener('click', () => {
				window.scrollTo({ top: 0, behavior: 'smooth' });
			});

			// Inicializar
			updateScrollProgress(window.scrollY);
		</script>
	</body>
</html>
